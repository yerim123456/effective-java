# ì•„ì´í…œ 30. ì´ì™•ì´ë©´ ì œë„¤ë¦­ ë©”ì„œë“œë¡œ ë§Œë“¤ë¼

### í•µì‹¬ ì •ë¦¬
>- ë§¤ê°œ ë³€ìˆ˜í™” íƒ€ì…ì„ ë°›ëŠ” ì •ì  ìœ í‹¸ë¦¬í‹° ë©”ì„œë“œ
>  - í•œì •ì  ì™€ì¼ë“œì¹´ë“œ íƒ€ì„(ì•„ì´í…œ 31)ì„ ì‚¬ìš©í•˜ë©´ ë” ìœ ì—°í•˜ê²Œ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
> - ì œë„¤ë¦­ ì‹±ê¸€í„´ íŒ©í„°ë¦¬
>   - (ì†Œê±° ë°©ì‹ì´ê¸° ë•Œë¬¸ì—) ë¶ˆë³€ ê°ì²´ í•˜ë‚˜ë¥¼ ì–´ë–¤ íƒ€ì…ìœ¼ë¡œê·¼ ë§¤ê°œ ë³€ìˆ˜í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> - ì¬ê·€ì  íƒ€ì… í•œì •
>   - ìê¸° ìì‹ ì´ ë“¤ì–´ê°„ í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ íƒ€ì… ë§¤ê°œ ë³€ìˆ˜ì˜ í—ˆìš©ë²”ìœ„ë¥¼ í•œì •í•©ë‹ˆë‹¤.

## ì œë„¤ë¦­ ë©”ì†Œë“œ

---
![img_1.png](https://github.com/effective-java-3e-study/effective-java/pull/22/files#diff-dd3d4e60cd9909c0be794599b89e54c3ce9c257f5532938eb918be867716463c)
ì œë„¤ë¦­ ë©”ì†Œë“œë€ ì œë„¤ë¦­ ë©”ì†Œë“œëŠ” ë©”ì†Œë“œì˜ ì„ ì–¸ ë¶€ì— ì ì€ ì œë„¤ë¦­ìœ¼ë¡œ ë¦¬í„´ íƒ€ì…, íŒŒë¼ë¯¸í„°ì˜ íƒ€ì…ì´ ì •í•´ì§€ëŠ” ë©”ì†Œë“œì…ë‹ˆë‹¤.

```java

// ì˜ëª»ëœ ì˜ˆì‹œ
public class Student<T> {
static T name;
}
```
static ë³€ìˆ˜ëŠ” ì œë„¤ë¦­ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 
ì™œëƒí•˜ë©´ Student í´ë˜ìŠ¤ê°€ ì¸ìŠ¤í„´ìŠ¤ ë˜ê¸° ì „ì— staticì€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°€ëŠ”ë° ì´ë•Œ nameì˜ íƒ€ì…ì¸ Tê°€ ê²°ì •ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
static ë©”ì†Œë“œì—ë„ ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ”ë° static ë³€ìˆ˜ì™€ ë§ˆì°¬ê°€ì§€ë¡œ Student í´ë˜ìŠ¤ê°€ ì¸ìŠ¤í„´ìŠ¤í™” ë˜ê¸° ì „ì— ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°€ëŠ”ë°
Tì˜ íƒ€ì…ì´ ì •í•´ì§€ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

```java
public class Student<T> {

    static <T> T getOneStudent(T id) {
        return id;
    }
}
```

ê·¸ëŸ¬ë‚˜ ì œë„¤ë¦­ ë©”ì†Œë“œëŠ” staticì´ ê°€ëŠ¥ í•©ë‹ˆë‹¤.
ì œë„¤ë¦­ ë©”ì†Œë“œëŠ” í˜¸ì¶œ ì‹œì— ë§¤ê°œ íƒ€ì…ì„ ì§€ì •í•˜ê¸° ë•Œë¬¸ì— staticì´ ê°€ëŠ¥í•˜ê²Œ ë©ë‹ˆë‹¤.



## ë§¤ê°œ ë³€ìˆ˜í™” íƒ€ì…ì„ ë°›ëŠ” ì •ì  ìœ í‹¸ë¦¬í‹° ë©”ì„œë“œ

---

```java
public class Union {
    public static Set union(Set s1, Set s2) {
        Set result = new HashSet(s1);
        result.addAll(s2);
        return result;
    }
    public static void main(String[] args) {
        Set guys = Set.of("ê¶Œì§€ìš©", "ë™ì˜ë°°", "ê°•ëŒ€ì„±");
        Set stooges = Set.of(1, 2, 3);
        Set all = union(guys, stooges);

        for (Object o : all){
            System.out.println((String) o);
        }
    }
}

```
ìœ„ ì½”ë“œì˜ ì¶œë ¥ê²°ê³¼ 
![img.png](https://github.com/effective-java-3e-study/effective-java/pull/22/files#diff-e8fa08a9ff6d4a1ab714e1286e8f84237bd606f67b5d1cb47ea94d79c5e983cc?raw=true)
ClassCastExceptionì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë¬¸ìì—´ì´ ì•„ë‹Œ ê²ƒë“¤ì„ ë¬¸ìì—´ë¡œ ë°”ê¾¸ë ¤ê³  í•˜ì—¬ `ëŸ°íƒ€ì„ì—ëŸ¬`ê°€ ë°œìƒí•©ë‹ˆë‹¤. 

ğŸ‘‰ğŸ» ì´ëŸ° ë¬¸ì œë“¤ì„ `ì»´íŒŒì¼ íƒ€ì„` ì— ë°©ì§€ë¥¼ í•˜ê¸° ìœ„í•´ì„œ genricí•œ íƒ€ì…ì„ ì‚¬ìš©í•œ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤. 

![img.png](https://github.com/effective-java-3e-study/effective-java/pull/22/files#diff-8743aa813e297346df253792622dd8e7b87f3c5ea11c76f184391995ac752000?raw=true)
-> ì»´íŒŒì¼ ì—ëŸ¬ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤. 

#### ë©”ì„œë“œì—ì„œì¡°ì°¨ë„ raw íƒ€ì…ì„ ì“°ì§€ ë§™ì‹œë‹¤.
```java 

public static Set union(Set s1, Set s2) {
    Set result = new HashSet(s1);
    result.addAll(s2);
    return result;
}
```
ì´ë ‡ê²Œ ë§¤ê°œë³€ìˆ˜ì˜ íƒ€ì…ì´ë‚˜ ë°˜í™˜ íƒ€ì…ìœ¼ë¡œ raw íƒ€ì…ì„ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ ì»´íŒŒì¼ì€ ê°€ëŠ¥í•˜ì§€ë§Œ
new HashSetì„ í•˜ëŠ” ê³¼ì •ê³¼ resultì— s2ë¥¼ addAll í•˜ëŠ” ê³¼ì •ì—ì„œ raw íƒ€ì…ì— ëŒ€í•œ ê²½ê³ ê°€ ë°œìƒí•˜ê²Œ ë©ë‹ˆë‹¤.


###  ë©”ì„œë“œì— ì œë„¤ë¦­ ì‚¬ìš©í•˜ê¸°: íƒ€ì… ì•ˆì „ì„± í™•ë³´
```java
public class Union {
    public static <E> Set <E> union(Set<E> s1, Set<E> s2)  {
        Set <E> result = new HashSet<>(s1);
        result.addAll(s2);
        return result;
    }
    public static void main(String[] args) {
        Set <String> guys = Set.of("ê¶Œì§€ìš©", "ë™ì˜ë°°", "ê°•ëŒ€ì„±");
        Set <String> stooges = Set.of("ìµœìœ¤ì •","ìµœìœ¤ì£¼","ì´ìˆ˜ì—°");
        Set <String> all = union(guys, stooges);

        for (String o : all){
            System.out.println(o);
        }
    }
}


```

 ğŸ‘‰ğŸ» ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ë©´, union ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì— ì»´íŒŒì¼ëŸ¬ê°€ ë§¤ê°œë³€ìˆ˜ì™€ ë°˜í™˜ íƒ€ì…ì„ ê²€ì‚¬í•©ë‹ˆë‹¤. 
 ë•ë¶„ì— ì„œë¡œ ë‹¤ë¥¸ íƒ€ì…ì„ í•©ì¹˜ë ¤ í•  ë•Œ ì»´íŒŒì¼ ì—ëŸ¬ë‚˜ ê²½ê³ ë¥¼ ëª…í™•í•˜ê²Œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë§¨ ì²˜ìŒì— ì˜ˆì‹œì—ì„œ ì²˜ëŸ¼  Set<String>ê³¼ Set<Integer>ë¥¼ í•©ì¹˜ë ¤ í•˜ë©´ ì»´íŒŒì¼ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë¯€ë¡œ,
 ì˜ëª»ëœ í˜¸ì¶œ ìì²´ë¥¼ ì›ì²œì ìœ¼ë¡œ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¶œë ¥ê²°ê³¼ëŠ”
![img.png](https://github.com/effective-java-3e-study/effective-java/pull/22/files#diff-575961f0cfc3026fb50f843c32fca36f4d51ecab48f5bffc3a968a51e60c9757?raw=true)
ì •ìƒì ìœ¼ë¡œ ì¶œë ¥ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤. 

### (ì°¸ê³ ) ì œë„¤ë¦­ ë©”ì„œë“œì˜ í™œìš© ì˜ˆì‹œ: Collections.binarySearch

ìë°” í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ìˆëŠ” Collections.binarySearch ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

```java
public static <T>
int binarySearch(List<? extends Comparable<? super T>> list, T key) {
    if (list instanceof RandomAccess || list.size() < BINARYSEARCH_THRESHOLD)
        return Collections.indexedBinarySearch(list, key);
    else
        return Collections.iteratorBinarySearch(list, key);
}
```
ì—¬ê¸°ì„œë„ ë©”ì„œë“œì— ì œë„¤ë¦­ì´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.
- public static <T>: ë©”ì„œë“œì— Të¼ëŠ” íƒ€ì… ë§¤ê°œë³€ìˆ˜ë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.
- List<? extends Comparable<? super T>> list, T key:

	â€¢	listê°€ Të¥¼ ë¹„êµí•  ìˆ˜ ìˆëŠ” Comparableì„ êµ¬í˜„í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì„ í‘œí˜„í•˜ê¸° ìœ„í•´ ì™€ì¼ë“œì¹´ë“œ(?)ì™€ ìƒìœ„ ê²½ê³„(super)ë¥¼ ì¡°í•©í•´ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
	 ì´ ë§ì€ â€œlist ë‚´ë¶€ ìš”ì†Œì˜ íƒ€ì…ì€ Tì™€ ë¹„êµ ê°€ëŠ¥í•´ì•¼ í•œë‹¤â€ë¼ëŠ” ì œì•½ì„ ê±¸ì–´ ë†“ì€ ê²ƒì…ë‹ˆë‹¤.
-  ì™€ì¼ë“œì¹´ë“œì™€ ì œë„¤ë¦­ íƒ€ì… ë§¤ê°œë³€ìˆ˜ë¥¼ ì ì ˆíˆ ì„ì–´ì„œ, ë©”ì„œë“œê°€ íƒ€ì… ì•ˆì •ì„±ì„ ìœ ì§€í•˜ë©´ì„œë„ ìœ ì—°í•˜ê²Œ ì‘ì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë§Œì•½ ì•„ë˜ì²˜ëŸ¼ <T> ë¶€ë¶„ì„ ë¹¼ë†“ê³  ì‘ì„±í•´ ë²„ë¦¬ë©´,
```java
public static
int binarySearch(List<? extends Comparable<? super T>> list, T key) { ... }
```
- Të¼ëŠ” ì‹¬ë²Œì´ ë¬´ì—‡ì¸ì§€ ì»´íŒŒì¼ëŸ¬ê°€ ì•Œ ìˆ˜ ì—†ì–´ì„œ `Cannot resolve symbol â€˜Tâ€™`ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.
- ë©”ì„œë“œê°€ ë”°ë¡œ íƒ€ì… ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤ë©´, ë°˜ë“œì‹œ <T>ì™€ ê°™ì€ ì„ ì–¸ì„ ë©”ì„œë“œ ì œí•œìì™€ ë°˜í™˜ íƒ€ì… ì‚¬ì´ì— ì ì–´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.

ë‹¨, í´ë˜ìŠ¤ê°€ ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ë¼ë©´, ë©”ì„œë“œì—ì„œ ê°™ì€ ì œë„¤ë¦­ì„ ì‚¬ìš©í•  ë•ŒëŠ” íƒ€ì… ë§¤ê°œë³€ìˆ˜ë¥¼ ì§€ì •í•´ì£¼ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.
```java
public class Stack<E> {

    private E[] elements;

    ...

    public E pop() {
        if (size == 0) {
            throw new EmptyStackException();
        }
        E result = elements[--size];
        elements[size] = null;
        return result;
    }

    ...
}
```
pop ë©”ì„œë“œëŠ” Eë¼ëŠ” íƒ€ì…ì„ ë°˜í™˜í•˜ê²Œ ë©ë‹ˆë‹¤. 
ìœ„ì—ì„œ ë³¸ ì œë„¤ë¦­ ë©”ì„œë“œ ê·œì¹™ì— ì˜í•˜ë©´ public <E> pop() ì´ ë˜ì–´ì•¼ í•  ê²ƒ ê°™ì§€ë§Œ Stack í´ë˜ìŠ¤ ì„ ì–¸ ìì²´ì— ì§€ì •ëœ E íƒ€ì…ì„ ì‚¬ìš©í•´ì£¼ê¸° ìœ„í•´ ë§¤ê²¨ë³€ìˆ˜ ëª©ë¡ìœ¼ë¡œ <E>ë¥¼ ë„£ì–´ì£¼ê²Œ ë˜ë©´ ì˜¤íˆë ¤ ê¸°ì¡´ì— í´ë˜ìŠ¤ì—ì„œ ìœ ì§€í•˜ê³  ìˆë˜ ì œë„¤ë¦­ Eì™€ ê°™ì€ íƒ€ì…ì´ ì•„ë‹ˆë¼ê³  íŒë‹¨í•˜ê²Œ ë©ë‹ˆë‹¤.

### ì œë„¤ë¦­ ì‹±ê¸€í†¤ íŒ©í„°ë¦¬

---

identityFunction ë©”ì„œë“œë¥¼ ì œë„¤ë¦­ ì‹±ê¸€í„´ íŒ©í† ë¦¬ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„í•´ë³´ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.

sameString ê³¼ sameNumber ëŠ” ë¶„ëª… ë‹¤ë¥¸ íƒ€ì…ì— ë”°ë¼ ë™ì‘í•˜ëŠ” í•¨ìˆ˜ì„ì—ë„ ë¶ˆêµ¬í•˜ê³ , 
indentityFunctionì´ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë‹¤ë§Œ ê°™ì€ IDENTITY_FUNCTION ê°ì²´ë¥¼ ë¹„ê²€ì‚¬ í˜•ë³€í™˜í•˜ê³  ìˆì„ ë¿ ì…ë‹ˆë‹¤.

IDENTITY_FUNCTION ì´ ì‹±ê¸€í†¤ ê°ì²´ì²˜ëŸ¼ ì‚¬ìš©ë˜ê³  ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ì œë„¤ë¦­  `ì‹±ê¸€í„´ íŒ©í† ë¦¬ íŒ¨í„´ `ì´ë¼ê³  í•©ë‹ˆë‹¤.


#### Before
```java
public class GenericSingletonFactory {
public static Function<String, String> stringIdentifyFuntion() {
return (t) -> t;
}

    public static Function<Number, Number> integerIdentifyFuntion() {
        return (t) -> t;
    }

    public static void main(String[] args) {
        String[] strings = {"ë²„í”¼", "ë‘ë¶€", "ì´ˆì½”"};
        Function<String, String> sameString = stringIdentifyFuntion();
        for (String s : strings) {
            System.out.println(sameString.apply(s));
        }

        Number[] numbers = {1, 2.0, 3L};
        Function<Number, Number> sameNumber= integerIdentifyFuntion();
        for (Number number : numbers) {
            System.out.println(sameNumber.apply(number));
        }
    }

}
```
ìë°”ì˜ ì œë„¤ë¦­ì´ ì‹¤ì²´í™”ëœë‹¤ë©´ í•­ë“±í•¨ìˆ˜ë¥¼ íƒ€ì…ë³„ë¡œ í•˜ë‚˜ì”© ë§Œë“¤ì–´ì•¼ í–ˆê² ì§€ë§Œ
ì†Œê±° ë°©ì‹ì„ ì‚¬ìš©í•œ ë•ì— ì œë„¤ë¦­ ì‹±ê¸€í„´ í•˜ë‚˜ë©´ ì¶©ë¶„í•˜ê²Œ ë©ë‹ˆë‹¤.
 -> ì œë„¤ë¦­ì€ ì†Œê±°ë°©ì‹ì´ ë•Œë¬¸ì— íƒ€ì… ì •ë³´ê°€ ì‚¬ë¼ì ¸ ê°™ì€ ê°ì²´ ì·¨ê¸‰í•©ë‹ˆë‹¤.


#### After
```java
public class GenericSingletonFactory {
    private static UnaryOperator<Object> IDENTITY_FN= (t)->t;

    @SuppressWarnings("unchecked")
    private static <T> UnaryOperator<T> identityFunction(){
        return (UnaryOperator<T>)IDENTITY_FN;
    }
    public static void main(String[] args) {
        String[] strings = {"ë²„í”¼", "ë‘ë¶€", "ì´ˆì½”"};
        UnaryOperator<String> sameString = identityFunction(); // í˜¸ì¶œí•˜ëŠ” ìª½ì—ì„œ íƒ€ì…ì„ ì •í•˜ë©´ ë©ë‹ˆë‹¤.
        for (String str: strings) {
            System.out.println(sameString.apply(str));
        }

        Integer[] numbers = { 1, 2, 3 };
        UnaryOperator<Integer> sameNumber = identityFunction();
        for (Integer num: numbers) {
            System.out.println(sameNumber.apply(num));
        }
    }

}


```

ğŸ‘‰ğŸ»ê²°ë¡ ì ìœ¼ë¡œ, ë™ì¼í•œ ì˜¤ë¸Œì íŠ¸ í•¨ìˆ˜ë¥¼ ì“°ê³  ëŸ°íƒ€ì„ì‹œ íƒ€ì… ìºìŠ¤íŒ…ì´ ì¼ì–´ë‚˜ë„ë¡í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

---
## ì¬ê·€ì  íƒ€ì… í•œì •
ë‹¤ìŒì€ max ë©”ì„œë“œë¥¼ ì¬ê·€ì  íƒ€ì… í•œì •ì„ í™œìš©í•´ êµ¬í˜„í•´ë³´ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤.
<E extends Comparable<E>> ë¥¼ í†µí•´, max ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì…ë ¥ë°›ì€ collection ì˜ ì›ì†Œì— Comparable ì´ êµ¬í˜„ë˜ì–´ ìˆì–´ì•¼ í•¨ì„
ì»´íŒŒì¼ íƒ€ì„ì—ì„œ íƒ€ì…ì²´í¬ë¥¼ í†µí•´ ê°•ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
public class RecursiveTypeBound {
    public static <E extends Comparable<E>>E max(Collection<E> c) {
        if (c.isEmpty())
            throw new IllegalArgumentException("ì»¬ë ‰ì…˜ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.");

        E result = null;
        for (E e : c)
            if (result == null || e.compareTo(result) > 0)
                result = Objects.requireNonNull(e);

        return result;

    }

    public static void main(String[] args) {
        List<String> arglist = Arrays.asList(args);
        System.out.println(max(arglist));

    }
}


```
