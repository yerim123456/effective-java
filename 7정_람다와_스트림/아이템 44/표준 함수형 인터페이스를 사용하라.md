## item 44

### ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λΌ

---

```java
protected boolean removeEldestEntry(Map.Entry<K,V> eldest){
    return size() > 100;
}
```
μ„ μ½”λ“λ” `LinkedHAshMap` ν΄λμ¤μ protected λ©”μ„λ“μΈ `removeEldestEntry` λ©”μ„λ“λ¥Ό
μ¬μ •μν• κ²ƒμ…λ‹λ‹¤. `μ΄λ” μ λ™μ‘ν•μ§€λ§, λλ‹¤λ¥Ό μ‚¬μ©ν•λ©΄ ν›¨μ”¬ μ ν•΄λ‚Ό μ μμµλ‹λ‹¤!`

μλ°”κ°€ λλ‹¤λ¥Ό μ§€μ›ν•λ©΄μ„ APIλ¥Ό μ‘μ„±ν•λ” λ¨λ²” μ‚¬λ΅€λ„ ν¬κ² λ°”λ€μ—κΈ°μ—,
μ„μ μ½”λ“μ²λΌ μ‚¬μ„ ν΄λμ¤μ κΈ°λ³Έ λ©”μ„λ“λ¥Ό μ¬μ •μν•΄ μ›ν•λ” λ™μ‘μ„ κµ¬ν„ν•λ” `ν…ν”λ¦Ώ λ©”μ„λ“ ν¨ν„΄`λ³΄λ‹¤
κ°™μ€ ν¨κ³Όμ ν•¨μ κ°μ²΄λ¥Ό λ°›λ” `μ •μ  ν©ν„°λ¦¬λ‚ μƒμ„±μ μ κ³µ`μΌλ΅ λ€μ²΄λκ³  μμµλ‹λ‹¤.

λλ‹¤λ” λ‹¨ ν•λ‚μ μ¶”μƒ λ©”μ„λ“λ¥Ό κ°€μ§„ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•  λ• μ‚¬μ©λ©λ‹λ‹¤.
λ”°λΌμ„ μ„μ μ½”λ“λ¥Ό λλ‹¤λ΅ λ€μ²΄ν•κΈ° μ„ν•΄ κµ¬ν„ν• `ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤`λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

```java
@FunctionalInterface interface EldestEntryRemovalFunction<K,V>{
    // removeEldestEntry μ—μ„ size λ©”μ„λ“λ¥Ό μ‚¬μ©ν•λ”λ° μ΄κ² μΈμ¤ν„΄μ¤ λ©”μ„λ“λΌ, 
    // ν©ν„°λ¦¬λ‚ μƒμ„±μλ¥Ό νΈμ¶ν•  λ•λ” λ§µμ μΈμ¤ν„΄μ¤κ°€ μ΅΄μ¬ν•μ§€ μ•μμ„ κ³ λ ¤ν•μ—¬ μΈμ¤ν„΄μ¤ μ „λ‹¬ ν•„μ”
    boolean remove(Map<K,V> map, Map.Entry<K,V> eldest);
}
```

---

### π™ μ„μ μΈν„°νμ΄μ¤λ„ μ λ™μ‘ν•μ§€λ§, κµ³μ΄ μ‚¬μ©ν•  μ΄μ λ” μ—†μµλ‹λ‹¤.

μ™λƒλ©΄! μ΄λ―Έ κ°™μ€ λ¨μ–‘μ μΈν„°νμ΄μ¤κ°€ μ¤€λΉ„λμ–΄ μκΈ° λ•λ¬Έμ…λ‹λ‹¤. 
java.util.function ν¨ν‚¤μ§€λ¥Ό λ³΄λ©΄ λ‹¤μ–‘ν• μ©λ„μ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤κ°€ λ‹΄κ²¨ μμµλ‹λ‹¤.
λ”°λΌμ„ `ν•„μ”ν• μ©λ„μ— λ§λ” κ² μλ‹¤λ©΄, μ§μ ‘ κµ¬ν„ν•μ§€ λ§κ³  ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό ν™μ©ν•λΌ` κ³  ν•©λ‹λ‹¤!

μ„μ μ½”λ“μ κ²½μ°, μ§μ ‘ λ§λ“  `EldestEntryRemovalFunction` λ€μ‹ , 
ν‘μ¤€ μΈν„°νμ΄μ¤μΈ `BiPredicate<Map<K,V>, Map.Entry<K,V>>` λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

---

### π™‹β€β™€οΈ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό ν™μ©ν•λ” κ²ƒμ μ¥μ μ€ λ­”κ°€μ”?

1) APIκ°€ λ‹¤λ£¨λ” κ°λ…μ μ β†“ > μµνκΈ° μ‰¬μ›€
2) μ κ³µλ λ§μ€ λ””ν΄νΈ λ©”μ„λ“ > λ‹¤λ¥Έ μ½”λ“μ™€μ μƒνΈμ΄μμ„± μΆ‹μ•„μ§
   - ex) `predicate` μΈν„°νμ΄μ¤μ `predicate` λ“¤μ„ μ΅°ν•©ν•λ” λ©”μ„λ“ μ κ³µ(`and()`, `or()`, `negate()` λ“±)
   <details> <summary>π“ predicate μ΅°ν•© λ©”μ„λ“</summary>

    | λ©”μ„λ“ | μ„¤λ… | μμ  |
    |--------|------|------|
    | `and(Predicate<T> other)` | λ‘ κ°μ Predicateλ¥Ό AND μ—°μ‚°μΌλ΅ μ΅°ν•© | `p1.and(p2)` |
    | `or(Predicate<T> other)` | λ‘ κ°μ Predicateλ¥Ό OR μ—°μ‚°μΌλ΅ μ΅°ν•© | `p1.or(p2)` |
    | `negate()` | ν„μ¬ Predicateμ κ²°κ³Όλ¥Ό λ°λ€λ΅ λ°ν™ | `p1.negate()` |
    | `isEqual(Object targetRef)` | μ£Όμ–΄μ§„ κ°μ²΄μ™€ κ°™μ€μ§€ κ²€μ‚¬ν•λ” Predicate λ°ν™ | `Predicate.isEqual("test")` |
    </details>

---

### π™ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤ κΈ°λ³Έ μΆ…λ¥ 6κ°€μ§€

μ΄ κΈ°λ³Έ μΈν„°νμ΄μ¤λ“¤μ€ λ¨λ‘ μ°Έμ΅° νƒ€μ…μ©μ…λ‹λ‹¤.

| μΈν„°νμ΄μ¤          | λ§¤κ°λ³€μ | λ°ν™κ°’ | μ„¤λ…                                              |
|------------------|--------|--------|-------------------------------------------------|
| `UnaryOperator<T>` | T      | T      | μΈμκ°€ 1κ°μΈ κ²ƒμΌλ΅ λ°ν™κ°’κ³Ό μΈμ νƒ€μ…μ΄ κ°™μ€ ν•¨μ   |
| `BinaryOperator<T>` | (T, T) | T      |μΈμκ°€ 2κ°μΈ κ²ƒμΌλ΅ λ°ν™κ°’κ³Ό μΈμ νƒ€μ…μ΄ κ°™μ€ ν•¨μ |
| `Predicate<T>`    | T      | boolean | μΈμ 1κ°λ¥Ό λ°›μ•„ booleanμ„ λ°ν™ν•λ” ν•¨μ                      |
| `Function<T, R>`  | T      | R      | μΈμμ™€ λ°ν™ νƒ€μ…μ΄ λ‹¤λ¥Έ ν•¨μ                                |
| `Supplier<T>`     | μ—†μ    | T      | μΈμλ¥Ό λ°›μ§€ μ•κ³  κ°’μ„ λ°ν™(νΉμ€ μ κ³µ)ν•λ” ν•¨μ                     |
| `Consumer<T>`     | T      | μ—†μ    | μΈμλ¥Ό ν•λ‚ λ°›κ³  λ°ν™κ°’μ€ μ—†λ”(μΈμλ¥Ό μ†λΉ„ν•λ”) ν•¨μ                  |

μ„μ κΈ°λ³Έ μΈν„°νμ΄μ¤λ” κΈ°λ³Έ νƒ€μ…μΈ int, long, double μ©μΌλ΅ κ° 3κ°μ”© λ³€ν•μ΄ μƒκ²¨λ‚©λ‹λ‹¤.
μ΄λ¦„μ€ `BinaryOperator`μ—μ„ `LongBinaryOperator` λ΅ μ΄λ¦„ μ•μ— ν•΄λ‹Ή κΈ°λ³Έ νƒ€μ… μ΄λ¦„μ„ λ¶™μ…λ‹λ‹¤.
μ΄ λ³€ν•λ“¤ μ¤‘ μ μΌν•κ² Functionμ λ³€ν•λ§ λ§¤κ°λ³€μν™” λμ—μµλ‹λ‹¤. 
μ¦‰, Function μΈν„°νμ΄μ¤μ κΈ°λ³Έ νƒ€μ… λ³€ν•λ§ μ λ„¤λ¦­μ΄ μ•„λ‹λΌ κµ¬μ²΄μ μΈ νƒ€μ…μ„ λ…μ‹μ μΌλ΅ μ‚¬μ©ν•©λ‹λ‹¤.

---

### π™‹β€β™€οΈ μ™ Functionμ λ³€ν•μ€ λ§¤κ°λ³€μν™” λλ”κ±΄κ°€μ”?

`Function` μΈν„°νμ΄μ¤λ” μ…λ ¥κ³Ό μ¶λ ¥μ νƒ€μ…μ΄ λ‹¤λ¥Ό μ μκΈ° λ•λ¬Έμ— κ·Έλ ‡μµλ‹λ‹¤!
`Function` μΈν„°νμ΄μ¤λ” κΈ°λ³Έ νƒ€μ…μ„ λ°ν™ν•λ” λ³€ν•μ΄ 9κ°κ°€ μ΅΄μ¬ν•©λ‹λ‹¤.
λ¨λ‘ κΈ°λ³Έ νƒ€μ…μ΄λΌλ©΄, `SrcToResult` λ΅ `LongToIntFunction` μΌλ΅ μ§„ν–‰ν•©λ‹λ‹¤.(μ΄ 6κ°)
μ…λ ¥μ΄ κ°μ²΄ μ°Έμ΅°μ΄κ³  κ²°κ³Όκ°€ `int`, `long`, `double` λΌλ©΄(μ΄ 3κ°), `ToLongFunction<int[]>` λ΅ `int[]` μΈμλ¥Ό λ°›μ•„ `long`μ„ λ°ν™ν•λ‹¤λ” κ²ƒμ„ μ ‘λ‘μ–΄λ΅ `ToResult` λ¥Ό λ¶™μ—¬ μ‚¬μ©ν•©λ‹λ‹¤.

---

### π™ κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤ μ¤‘ 3κ°μ—λ” μΈμλ¥Ό 2κ°μ”© λ°›λ” λ³€ν•μ΄ μμµλ‹λ‹¤.

`BiPredicate<T,U>` `BiFunction<T,U,R>` `BiConsumer<T,U>` μ…λ‹λ‹¤.
1. BiPredicate<T, U>
    - λ‘ κ°μ μ…λ ¥(T, U)μ„ λ°›μ•„ booleanμ„ λ°ν™ν•λ” ν•¨μμ…λ‹λ‹¤.
2. BiFunction<T, U, R>
   - λ‘ κ°μ μ…λ ¥(T, U)μ„ λ°›μ•„ ν•λ‚μ κ²°κ³Ό(R)λ¥Ό λ°ν™ν•λ” ν•¨μμ…λ‹λ‹¤.
3. BiConsumer<T, U>
   - λ‘ κ°μ μ…λ ¥(T, U)μ„ λ°›μ•„ μ•„λ¬΄κ²ƒλ„ λ°ν™ν•μ§€ μ•λ”(μ†λΉ„ν•λ”) ν•¨μμ…λ‹λ‹¤.

---

### π™ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤ μ‚¬μ© μ‹, μ£Όμμ !!

ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤ λ€λ¶€λ¶„μ΄ κΈ°λ³Έ νƒ€μ…λ§ μ§€μ›ν•λ‹¤κ³ , κΈ°λ³Έ ν•¨μν• μΈν„°νμ΄μ¤μ— λ°•μ‹±λ κΈ°λ³Έ νƒ€μ…μ„ λ„£μ–΄ μ‚¬μ©ν•μ§€λ” λ§μ•„μ•Ό ν•©λ‹λ‹¤.
λ™μ‘μ€ ν•μ§€λ§, κ³„μ‚°λ‰μ΄ λ§μ„ λ•λ” μ„±λ¥μ΄ μ²μ°Έν λλ ¤μ§ μ μμµλ‹λ‹¤.

---

### π™‹β€β™€οΈκµ¬μ΅°μ μΌλ΅ λ‘κ°™μ€ ν‘μ¤€ ν•¨μν• μΈν„°νμ΄μ¤κ°€ μλ”λΌλ„ μ§μ ‘ μ‘μ„±ν•΄μ•Ό ν•λ” κ²½μ°κ°€ μλ‚μ”?

μλ¥Ό λ“¤μ–΄ `Comparator<T>` μΈν„°νμ΄μ¤κ°€ μμµλ‹λ‹¤. μ΄λ” κµ¬μ΅°μ μΌλ΅ `ToIntBiFunction<T,U>` μ™€ λ™μΌν•©λ‹λ‹¤.

κ·ΈλΌμ—λ„, λ…μμ μΈ μΈν„°νμ΄μ¤λ΅ μ‚΄μ•„λ‚¨μ•„μ•Ό ν•λ” μ΄μ λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.
1. API μ—μ„ μμ£Ό μ‚¬μ©λλ”λ°, μ΄λ¦„μ΄ κ·Έ μ©λ„λ¥Ό λ…ν™•ν μ„¤λ…ν•©λ‹λ‹¤.
2. λ°λ“μ‹ λ”°λΌμ•Ό ν•λ” κ·μ•½μ„ λ‹΄κ³  μμµλ‹λ‹¤.
3. μ μ©ν• λ””ν΄νΈ λ©”μ„λ“λ¥Ό λ“¬λΏ μ κ³µν•κ³  μμµλ‹λ‹¤.

λ”°λΌμ„, λ‹¤μκ³Ό κ°™λ‹¤λ©΄ μ „μ© ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ” κ±΄ μ•„λ‹μ§€ μ§„μ¤‘ν κ³ λ―Όν•΄μ•Ό ν•©λ‹λ‹¤.

---

### π™ μ‘μ„±ν•λ” κ² μΈν„°νμ΄μ¤ μ„μ„ λ…μ‹¬ν•κ³  μ£Όμν•΄μ„ μ„¤κ³„ν•΄μ•Ό ν•©λ‹λ‹¤!!!

`@FunctionalInterface` μ΄ λ‹¬λ ¤ μμμ— μ£Όλ©ν•΄λ΄…μ‹λ‹¤!
μ΄ μ• λ„ν…μ΄μ…μ„ μ‚¬μ©ν•λ” μ΄μ λ” 3κ°€μ§€ λ©μ μ΄ μμµλ‹λ‹¤.
1. ν•΄λ‹Ή ν΄λμ¤μ μ½”λ“λ‚ μ„¤λ… λ¬Έμ„λ¥Ό μ½μ„ μ΄μ—κ² λλ‹¤μ©μΌλ΅ μ„¤κ³„λ μΈν„°νμ΄μ¤λΌκ³  μ•λ ¤μ£Όλ” κ²ƒ
2. ν•΄λ‹Ή μΈν„°νμ΄μ¤κ°€ μ¶”μƒ λ©”μ„λ“λ¥Ό μ¤μ§ ν•λ‚λ§ κ°€μ§€κ³  μμ–΄μ•Ό μ»΄νμΌλλ„λ΅ μ„¤μ •ν•λ” κ²ƒ
3. 2λ²μ κ²°κ³Όλ΅ μ μ§€λ³΄μ κ³Όμ •μ—μ„ λ„κµ°κ°€ μ‹¤μλ΅ λ©”μ„λ“λ¥Ό μ¶”κ°€ν•μ§€ λ»ν•κ² λ§‰μ

λ”°λΌμ„ κΌ­!! ν•΄λ‹Ή μ• λ„ν…μ΄μ…μ„ μ‚¬μ©ν•΄μ„ μ„¤κ³„ν•΄μ•Ό ν•©λ‹λ‹¤.

---

### π™ ν•¨μν• μΈν„°νμ΄μ¤ API μ‚¬μ©μ‹ μ£Όμμ 

**μ„λ΅ λ‹¤λ¥Έ ν•¨μν• μΈν„°νμ΄μ¤λ¥Ό κ°™μ€ μ„μΉμ μΈμλ΅ λ°›λ” λ©”μ„λ“λ“¤μ„ λ‹¤μ¤‘ μ •μ X**

μ΄μ : ν΄λΌμ΄μ–ΈνΈμ—κ² λ¶ν•„μ”ν• λ¨νΈν•¨μ„ μ•κ²¨ μ£Όλ©°, μ‹¤μ λ΅ λ¬Έμ κ°€ μΌμ–΄λ‚κΈ°λ„ ν•¨
     - `ExecutorService` μ κ²½μ°, submit λ©”μ„λ“ λ‚΄λ¶€μ— `Callable<T>` μ™€ `Runnable`μ„ λ°›λ” κ²ƒμ„ λ‹¤μ¤‘ μ •μ ν•¨
     - κ·Έ κ²°κ³Ό μ¬λ°”λ¥Έ λ©”μ„λ“λ¥Ό μ•λ ¤μ£ΌκΈ° μ„ν•΄ ν•λ³€ν™ν•΄μ•Ό ν•  λ•κ°€ μμ£Ό μƒκΈ°λ” λ¬Έμ  λ°μƒν•¨
